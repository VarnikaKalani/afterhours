<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> AfterHours - milk & cookies</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --cream: #F7F4EF;
            --warm-beige: #E8DFD4;
            --soft-brown: #A8967A;
            --muted-sage: #B5BAA3;
            --stone: #D4CEC3;
            --dark-neutral: #5A5245;
            --linen: #EDE7DD;
        }

        body {
            font-family: 'Optima', 'Didot', 'Segoe UI', sans-serif;
            background: var(--cream);
            color: var(--dark-neutral);
            line-height: 1.7;
            -webkit-font-smoothing: antialiased;
        }

        .container {
            max-width: 1300px;
            margin: 0 auto;
            padding: 0 40px;
        }

        /* Navigation */
        nav {
            padding: 30px 0;
            background: var(--linen);
            position: sticky;
            top: 0;
            z-index: 1000;
            border-bottom: 1px solid rgba(168, 150, 122, 0.15);
        }

        nav .container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
        }

        .logo {
            font-size: 26px;
            font-weight: 400;
            color: var(--dark-neutral);
            text-decoration: none;
            letter-spacing: 3px;
            text-transform: lowercase;
        }

        .nav-links {
            display: flex;
            list-style: none;
            gap: 36px;
            align-items: center;
            background: rgba(247, 244, 239, 0.75);
            padding: 10px 18px;
            border-radius: 999px;
            border: 1px solid rgba(168, 150, 122, 0.18);
            backdrop-filter: blur(8px);
        }

        .nav-links li {
            display: flex;
            align-items: center;
        }

        .nav-toggle {
            display: none;
            width: 44px;
            height: 44px;
            border-radius: 999px;
            border: 1px solid rgba(168, 150, 122, 0.25);
            background: var(--cream);
            align-items: center;
            justify-content: center;
            flex-direction: column;
            gap: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .nav-toggle span {
            width: 18px;
            height: 2px;
            background: var(--dark-neutral);
            border-radius: 999px;
            transition: transform 0.3s ease, opacity 0.3s ease;
        }

        nav.open .nav-toggle span:nth-child(1) {
            transform: translateY(6px) rotate(45deg);
        }

        nav.open .nav-toggle span:nth-child(2) {
            opacity: 0;
        }

        nav.open .nav-toggle span:nth-child(3) {
            transform: translateY(-6px) rotate(-45deg);
        }

        nav .nav-links a {
            color: var(--dark-neutral);
            text-decoration: none;
            transition: all 0.4s ease;
            font-size: 14px;
            letter-spacing: 1px;
            text-transform: lowercase;
            font-weight: 400;
            display: inline-flex;
            align-items: center;
            line-height: 1;
        }

        nav .nav-links a:hover {
            color: var(--soft-brown);
            opacity: 0.7;
        }

        .nav-dropdown {
            position: relative;
            padding-bottom: 0;
        }

        .nav-dropdown::after {
            content: "";
            position: absolute;
            left: -14px;
            right: -14px;
            top: 100%;
            height: 14px;
        }

        .nav-link::after {
            content: "â–¾";
            margin-left: 6px;
            font-size: 11px;
            opacity: 0.6;
        }

        .dropdown-menu {
            position: absolute;
            top: calc(100% + 10px);
            left: 0;
            transform: translate(0, -6px);
            min-width: 300px;
            background: var(--linen);
            border: 1px solid rgba(168, 150, 122, 0.2);
            border-radius: 18px;
            padding: 18px 20px;
            box-shadow: 0 18px 40px rgba(90, 82, 69, 0.12);
            display: flex;
            flex-direction: column;
            gap: 12px;
            z-index: 1200;
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
            transform: translate(-50%, -6px);
            transition: all 0.2s ease;
        }

        .dropdown-menu a {
            font-size: 16px;
            letter-spacing: 0.9px;
            padding: 12px 14px;
            border-radius: 10px;
            transition: all 0.3s ease;
            display: block;
        }

        .dropdown-menu a:hover {
            background: var(--warm-beige);
            color: var(--dark-neutral);
            opacity: 1;
        }

        .nav-dropdown:hover .dropdown-menu,
        .nav-dropdown:focus-within .dropdown-menu,
        .nav-dropdown.open .dropdown-menu {
            opacity: 1;
            visibility: visible;
            pointer-events: auto;
            transform: translate(0, 0);
        }

        .cart-icon {
            position: relative;
            cursor: pointer;
            font-size: 20px;
            color: var(--dark-neutral);
            transition: all 0.4s ease;
            opacity: 0.8;
            display: inline-flex;
            align-items: center;
            line-height: 1;
        }

        .cart-icon:hover {
            opacity: 1;
            transform: scale(1.05);
        }

        .cart-count {
            position: absolute;
            top: -6px;
            right: -8px;
            background: var(--soft-brown);
            color: var(--cream);
            border-radius: 50%;
            width: 18px;
            height: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: 500;
            font-family: 'Arial', sans-serif;
        }

        /* Hero Section */
        .hero {
            background: var(--warm-beige);
            padding: 40px 40px;
            text-align: left;
            position: relative;
            overflow: hidden;
            height: calc(100vh - 90px);
        }

        .hero-layout {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 48px;
            height: 100%;
        }

        .hero-content {
            position: relative;
            z-index: 1;
            max-width: 520px;
        }

        h1 {
            font-size: clamp(48px, 7vw, 86px);
            margin-bottom: 22px;
            color: var(--dark-neutral);
            font-weight: 300;
            letter-spacing: -1px;
            line-height: 1.1;
            font-family: 'Optima', serif;
        }

        .hero p {
            font-size: clamp(17px, 2vw, 20px);
            color: var(--soft-brown);
            margin-bottom: 28px;
            max-width: 500px;
            font-weight: 300;
            letter-spacing: 0.5px;
        }

        .hero-problem {
            margin: -10px auto 26px;
            max-width: 520px;
            font-size: 14px;
            line-height: 1.7;
            color: var(--dark-neutral);
            opacity: 0.7;
            letter-spacing: 0.6px;
            text-transform: lowercase;
        }

        .hero-problem span {
            font-weight: 500;
            color: var(--dark-neutral);
        }

        .hero-buttons {
            display: flex;
            gap: 20px;
            justify-content: flex-start;
            flex-wrap: wrap;
        }

        .hero-image {
            order: -1;
            flex: 0 0 calc(50vw + 40px);
            display: flex;
            align-items: center;
            justify-content: flex-start;
            margin-left: -40px;
            max-width: 680px;
            height: 100%;
            overflow: hidden;
            border-radius: 0;
            box-shadow: none;
            border: none;
        }

        .hero-image img,
        .hero-image video {
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: 35% 50%;
        }

        .btn-primary {
            display: inline-block;
            padding: 18px 50px;
            background: var(--soft-brown);
            color: var(--cream);
            text-decoration: none;
            border-radius: 50px;
            font-size: 15px;
            font-weight: 400;
            letter-spacing: 1.5px;
            transition: all 0.4s ease;
            text-transform: lowercase;
        }

        .btn-primary:hover {
            background: var(--dark-neutral);
            transform: translateY(-1px);
            box-shadow: 0 8px 25px rgba(90, 82, 69, 0.15);
        }

        .btn-secondary {
            display: inline-block;
            padding: 18px 50px;
            background: transparent;
            color: var(--dark-neutral);
            text-decoration: none;
            border-radius: 50px;
            font-size: 15px;
            font-weight: 400;
            letter-spacing: 1.5px;
            transition: all 0.4s ease;
            border: 1.5px solid var(--dark-neutral);
            text-transform: lowercase;
        }

        .btn-secondary:hover {
            background: var(--dark-neutral);
            color: var(--cream);
        }

        /* Featured Section */
        .featured {
            padding: 100px 40px;
            background: var(--cream);
        }

        h2 {
            font-size: clamp(36px, 5vw, 56px);
            margin-bottom: 20px;
            color: var(--dark-neutral);
            text-align: center;
            font-weight: 300;
            letter-spacing: -0.5px;
        }

        .section-subtitle {
            text-align: center;
            color: var(--soft-brown);
            margin-bottom: 80px;
            font-size: 16px;
            line-height: 1.8;
            font-weight: 300;
            letter-spacing: 0.5px;
        }

            .section-subtitle.compact {
                margin-bottom: 0;
            }

        .shop-header {
            text-align: center;
            margin-bottom: 32px;
        }

        .shop-header .section-subtitle {
            margin-bottom: 20px;
        }

        .shop-switch {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 14px;
            font-size: 12px;
            letter-spacing: 1.4px;
            text-transform: lowercase;
            color: var(--soft-brown);
        }

        .shop-switch a {
            text-decoration: none;
            color: var(--dark-neutral);
            opacity: 0.65;
            border-bottom: 1px solid transparent;
            padding-bottom: 4px;
            transition: all 0.3s ease;
        }

        .shop-switch a:hover {
            opacity: 1;
            color: var(--soft-brown);
            border-color: var(--soft-brown);
        }

        .shop-subtitle {
            text-align: center;
            font-size: 28px;
            font-weight: 300;
            color: var(--dark-neutral);
            letter-spacing: -0.3px;
            margin: 40px 0 14px;
        }

        .shop-header .section-subtitle {
            max-width: 640px;
            margin-left: auto;
            margin-right: auto;
        }

        .milk-header {
            display: flex;
            align-items: baseline;
            flex-direction: column;
            align-items: flex-start;
            gap: 8px;
            margin-top: 30px;
            margin-bottom: 16px;
            text-align: left;
        }

        .milk-header .shop-subtitle {
            margin: 0;
            text-align: left;
        }

        .milk-header .section-subtitle {
            margin: 0;
            max-width: 520px;
            text-align: left;
            color: var(--soft-brown);
        }

        /* Product Grid */
        .milk-grid {
            display: grid;
            grid-template-columns: repeat(4, minmax(0, 1fr));
            gap: 24px;
            margin-top: 30px;
        }

        .product-card {
            background: var(--linen);
            border-radius: 18px;
            overflow: hidden;
            transition: all 0.4s ease;
            border: 1px solid rgba(168, 150, 122, 0.1);
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .product-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 16px 36px rgba(90, 82, 69, 0.08);
        }

        .product-image {
            width: 100%;
            height: 210px;
            background: linear-gradient(135deg, var(--stone) 0%, var(--warm-beige) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .product-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            filter: contrast(0.95) brightness(1.05);
        }

        .product-image.emoji-only {
            font-size: 110px;
            filter: grayscale(0.1);
        }

        .product-icon {
            position: relative;
            z-index: 1;
            opacity: 0.9;
        }

        .product-content {
            padding: 20px 20px 22px;
            display: flex;
            flex-direction: column;
            gap: 12px;
            flex: 1;
        }

        .product-card h3 {
            font-size: 20px;
            color: var(--dark-neutral);
            margin-bottom: 4px;
            font-weight: 400;
            letter-spacing: 0.5px;
            line-height: 1.2;
            min-height: 2.4em;
        }

        .product-origin {
            font-size: 11px;
            color: var(--soft-brown);
            font-style: italic;
            margin-bottom: 0;
            letter-spacing: 0.8px;
            font-weight: 300;
        }

        .product-description {
            color: var(--dark-neutral);
            margin-bottom: 14px;
            font-size: 14px;
            line-height: 1.7;
            opacity: 0.85;
            font-weight: 300;
        }

        .wellness-note {
            padding: 14px 16px;
            background: rgba(181, 186, 163, 0.1);
            border-radius: 16px;
            font-size: 13px;
            color: var(--dark-neutral);
            margin-bottom: 18px;
            border-left: 2px solid var(--muted-sage);
            line-height: 1.6;
            font-weight: 300;
        }

        .product-description,
        .wellness-note {
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .wellness-note strong {
            color: var(--dark-neutral);
            font-weight: 400;
        }

        .product-price {
            font-size: 22px;
            color: var(--dark-neutral);
            font-weight: 300;
            margin: 0;
            letter-spacing: -0.5px;
        }

        .milk-meta {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
        }

        .milk-choice {
            font-size: 11px;
            color: var(--dark-neutral);
            letter-spacing: 0.6px;
            text-transform: lowercase;
            opacity: 0.7;
        }

        .product-options {
            display: none;
            gap: 10px;
            margin-top: 10px;
        }

        .product-card.options-open .product-options {
            display: grid;
        }

        .product-card.options-open .milk-add {
            display: block;
        }

        .option-row {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .option-label {
            display: block;
            font-size: 10px;
            color: var(--dark-neutral);
            margin: 0;
            font-weight: 400;
            letter-spacing: 1px;
            text-transform: lowercase;
            min-width: 76px;
        }

        .temp-selector, .sweetness-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 0;
            flex: 1;
        }

        .option-toggle {
            width: 100%;
            padding: 10px 14px;
            border-radius: 999px;
            border: 1px solid rgba(168, 150, 122, 0.22);
            background: var(--cream);
            color: var(--dark-neutral);
            font-size: 12px;
            letter-spacing: 1px;
            text-transform: lowercase;
            cursor: pointer;
            transition: all 0.25s ease;
        }

        .option-toggle:hover {
            background: var(--warm-beige);
        }

        .option-btn {
            flex: 1;
            padding: 14px;
            background: var(--cream);
            border: 1.5px solid rgba(168, 150, 122, 0.3);
            border-radius: 30px;
            color: var(--dark-neutral);
            cursor: pointer;
            font-size: 13px;
            transition: all 0.3s ease;
            font-weight: 400;
            letter-spacing: 0.5px;
        }

        .product-options .option-btn {
            padding: 10px 12px;
            font-size: 12px;
        }

        .option-btn:hover {
            background: var(--warm-beige);
            border-color: var(--soft-brown);
        }

        .option-btn.active {
            background: var(--soft-brown);
            border-color: var(--soft-brown);
            color: var(--cream);
        }

        .milk-add {
            display: none;
            padding: 12px;
            font-size: 12px;
            letter-spacing: 1.2px;
        }

        .add-to-cart {
            width: 100%;
            padding: 18px;
            background: var(--soft-brown);
            color: var(--cream);
            border: none;
            border-radius: 50px;
            font-size: 15px;
            font-weight: 400;
            cursor: pointer;
            transition: all 0.4s ease;
            letter-spacing: 1.5px;
            text-transform: lowercase;
        }

        .add-to-cart:hover {
            background: var(--dark-neutral);
            transform: translateY(-1px);
            box-shadow: 0 8px 20px rgba(90, 82, 69, 0.15);
        }

        .cookie-spotlight {
            margin-top: 36px;
            display: grid;
            grid-template-columns: minmax(200px, 320px) 1fr;
            gap: 24px;
            background: var(--linen);
            border-radius: 24px;
            border: 1px solid rgba(168, 150, 122, 0.18);
            overflow: hidden;
            align-items: stretch;
        }

        .cookie-spotlight .cookie-image {
            background: var(--warm-beige);
            min-height: 220px;
        }

        .cookie-spotlight .cookie-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }

        .cookie-spotlight .cookie-content {
            padding: 28px 30px;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .cookie-tag {
            font-size: 11px;
            letter-spacing: 1.2px;
            text-transform: lowercase;
            color: var(--soft-brown);
        }

        .cookie-spotlight h3 {
            font-size: 24px;
            margin: 0;
            color: var(--dark-neutral);
            font-weight: 400;
        }

        .cookie-desc {
            font-size: 14px;
            line-height: 1.7;
            color: var(--dark-neutral);
            opacity: 0.85;
        }

        .cookie-spotlight .product-price {
            font-size: 26px;
        }

        .cookie-spotlight .cookie-content {
            align-items: flex-start;
        }

        .cookie-spotlight .add-to-cart {
            width: auto;
            min-width: 180px;
            padding: 12px 28px;
            letter-spacing: 1px;
        }

        /* Add to cart animation */
        @keyframes itemAdded {
            0% { transform: scale(1); }
            50% { transform: scale(0.97); }
            100% { transform: scale(1); }
        }

        .add-to-cart.added {
            animation: itemAdded 0.4s ease;
            background: var(--muted-sage);
        }

        /* Cart notification */
        .cart-notification {
            position: fixed;
            top: 90px;
            right: 30px;
            background: var(--soft-brown);
            color: var(--cream);
            padding: 18px 30px;
            border-radius: 50px;
            box-shadow: 0 8px 30px rgba(90, 82, 69, 0.2);
            z-index: 2001;
            transform: translateX(400px);
            transition: transform 0.5s ease;
            font-size: 14px;
            font-weight: 400;
            letter-spacing: 0.5px;
        }

        .cart-notification.show {
            transform: translateX(0);
        }

        /* Bundles Section */
        .bundles {
            padding: 100px 40px;
            background: var(--warm-beige);
        }

        .bundle-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 40px;
            margin-top: 60px;
        }

        .bundle-card {
            background: var(--linen);
            border-radius: 24px;
            padding: 45px;
            border: 1.5px solid rgba(168, 150, 122, 0.2);
            position: relative;
            transition: all 0.5s ease;
        }

        .bundle-card:hover {
            transform: translateY(-6px);
            box-shadow: 0 20px 50px rgba(90, 82, 69, 0.08);
        }

        .bundle-badge {
            position: absolute;
            top: -14px;
            right: 30px;
            background: var(--soft-brown);
            color: var(--cream);
            padding: 8px 22px;
            border-radius: 30px;
            font-size: 11px;
            font-weight: 400;
            letter-spacing: 1.5px;
            text-transform: lowercase;
        }

        .bundle-card h3 {
            font-size: 28px;
            color: var(--dark-neutral);
            margin-bottom: 20px;
            font-weight: 400;
            letter-spacing: 0.5px;
        }

        .bundle-items {
            margin: 25px 0;
            color: var(--dark-neutral);
            line-height: 2;
            font-weight: 300;
        }

        .bundle-items li {
            margin-left: 20px;
            margin-bottom: 12px;
            opacity: 0.85;
        }

        .bundle-price {
            font-size: 36px;
            color: var(--dark-neutral);
            font-weight: 300;
            margin: 25px 0;
            letter-spacing: -0.5px;
        }

        .bundle-price span {
            font-size: 18px;
            text-decoration: line-through;
            opacity: 0.5;
            margin-left: 12px;
        }

        .bundle-note {
            margin-top: 16px;
            font-size: 13px;
            letter-spacing: 0.6px;
            text-transform: lowercase;
            color: var(--dark-neutral);
            opacity: 0.75;
            text-align: center;
        }

        .section-divider {
            height: 1px;
            background: rgba(168, 150, 122, 0.2);
            margin: 0 40px;
        }

        /* Reviews Section */
        .reviews {
            padding: 100px 40px;
            background: var(--cream);
        }

        .reviews-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }

        .review-card {
            background: var(--linen);
            border-radius: 24px;
            border: 1px solid rgba(168, 150, 122, 0.18);
            box-shadow: 0 18px 40px rgba(90, 82, 69, 0.06);
            padding: 24px;
            display: flex;
            flex-direction: column;
            gap: 14px;
        }

        .review-card.with-image {
            padding: 0;
            overflow: hidden;
        }

        .review-image {
            width: 100%;
            aspect-ratio: 4 / 3;
            background: var(--warm-beige);
            overflow: hidden;
        }

        .review-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }

        .review-card-body {
            padding: 22px 24px 26px;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .review-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
        }

        .review-product {
            font-size: 12px;
            letter-spacing: 0.8px;
            text-transform: lowercase;
            color: var(--soft-brown);
        }

        .review-meta {
            font-size: 11px;
            letter-spacing: 0.6px;
            color: var(--soft-brown);
            opacity: 0.9;
        }

        .review-stars {
            font-size: 12px;
            letter-spacing: 2px;
            color: var(--soft-brown);
            white-space: nowrap;
        }

        .review-body {
            font-size: 14px;
            line-height: 1.7;
            color: var(--dark-neutral);
            opacity: 0.9;
        }

        .reviewer {
            font-size: 12px;
            color: var(--dark-neutral);
            opacity: 0.75;
        }

        /* Origin Story Map */
        .origin-story {
            padding: 110px 40px;
            background: var(--warm-beige);
            color: var(--dark-neutral);
            position: relative;
            overflow: hidden;
        }

        .origin-story h2 {
            color: var(--dark-neutral);
        }

        .origin-grid {
            display: grid;
            grid-template-columns: minmax(0, 0.8fr) minmax(0, 1.2fr);
            gap: 38px;
            align-items: center;
        }

        .origin-copy {
            max-width: 560px;
        }

        .origin-copy h2 {
            text-align: left;
            margin-bottom: 18px;
            font-size: clamp(30px, 3.8vw, 44px);
            line-height: 1.15;
        }

        .origin-copy p {
            color: rgba(90, 82, 69, 0.75);
            font-weight: 300;
            letter-spacing: 0.3px;
            line-height: 1.9;
            margin-bottom: 18px;
        }

        .eyebrow {
            display: inline-block;
            margin-bottom: 12px;
            font-size: 14px;
            letter-spacing: 3px;
            text-transform: uppercase;
            color: var(--soft-brown);
        }

        .origin-map {
            position: relative;
            border-radius: 30px;
            padding: 32px;
            background: var(--cream);
            border: 1px solid rgba(168, 150, 122, 0.2);
            overflow: hidden;
            box-shadow: 0 25px 60px rgba(90, 82, 69, 0.15);
            margin-left: -22px;
        }

        .origin-map::before {
            content: "";
            position: absolute;
            inset: 0;
            background:
                radial-gradient(120% 120% at 0% 0%, rgba(168, 150, 122, 0.18), transparent 60%),
                linear-gradient(120deg, rgba(255, 255, 255, 0.35), transparent 40%),
                repeating-linear-gradient(0deg, rgba(168, 150, 122, 0.08), rgba(168, 150, 122, 0.08) 1px, transparent 1px, transparent 22px),
                repeating-linear-gradient(90deg, rgba(168, 150, 122, 0.06), rgba(168, 150, 122, 0.06) 1px, transparent 1px, transparent 22px);
            opacity: 0.5;
            z-index: 0;
        }

        .map-sheen {
            position: absolute;
            inset: 0;
            background: radial-gradient(70% 70% at 70% 30%, rgba(168, 150, 122, 0.2), transparent 65%);
            opacity: 0.6;
            z-index: 0;
        }

        .map-svg {
            position: relative;
            z-index: 1;
            width: 100%;
            height: auto;
            display: block;
        }

        .map-land path {
            fill: rgba(168, 150, 122, 0.08);
            stroke: rgba(168, 150, 122, 0.35);
            stroke-width: 1;
            stroke-linejoin: round;
            stroke-linecap: round;
        }

        .map-arc {
            stroke: rgba(90, 82, 69, 0.6);
            stroke-width: 2;
            fill: none;
            stroke-linecap: round;
            stroke-dasharray: 7 10;
            animation: arc-dash 8s linear infinite;
        }

        .map-arc[marker-end] {
            marker-end: url(#mapArrow);
        }

        .map-node {
            fill: var(--soft-brown);
            filter: drop-shadow(0 0 8px rgba(168, 150, 122, 0.5));
        }

        .map-node.destination {
            fill: var(--dark-neutral);
        }

        .map-pulse {
            fill: none;
            stroke: rgba(90, 82, 69, 0.6);
            stroke-width: 1.2;
            transform-origin: center;
            transform-box: fill-box;
            animation: pulse 2.6s ease-out infinite;
        }

        .map-label {
            font-size: 12px;
            fill: rgba(90, 82, 69, 0.85);
            font-family: 'Optima', serif;
            letter-spacing: 0.3px;
        }

        .map-label tspan {
            font-size: 12px;
        }

        .destination-label {
            font-weight: 600;
            fill: var(--dark-neutral);
        }

        .map-legend {
            position: relative;
            z-index: 1;
            margin-top: 16px;
            text-align: center;
            font-size: 12px;
            letter-spacing: 1.2px;
            text-transform: lowercase;
            color: rgba(90, 82, 69, 0.7);
        }

        .legend-dot {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 999px;
            background: var(--soft-brown);
            box-shadow: 0 0 10px rgba(168, 150, 122, 0.6);
            margin-right: 8px;
        }

        @keyframes arc-dash {
            to { stroke-dashoffset: -200; }
        }

        @keyframes pulse {
            0% {
                transform: scale(0.4);
                opacity: 0.9;
            }
            100% {
                transform: scale(2.1);
                opacity: 0;
            }
        }

        .cart-controls {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-top: 14px;
}

.qty-control {
  display: inline-flex;
  align-items: center;
  gap: 10px;
  background: var(--cream);
  border: 1px solid rgba(168, 150, 122, 0.18);
  border-radius: 999px;
  padding: 8px 12px;
}

.qty-btn {
  width: 28px;
  height: 28px;
  border-radius: 999px;
  border: 1px solid rgba(168, 150, 122, 0.22);
  background: var(--linen);
  color: var(--dark-neutral);
  cursor: pointer;
  transition: all 0.2s ease;
  font-size: 14px;
  line-height: 1;
}

.qty-btn:hover {
  background: var(--warm-beige);
  border-color: rgba(168, 150, 122, 0.35);
}

.qty-num {
  min-width: 22px;
  text-align: center;
  font-size: 14px;
  color: var(--dark-neutral);
  opacity: 0.85;
}

.mini-edit {
  display: inline-flex;
  gap: 8px;
  flex-wrap: wrap;
}

.mini-pill {
  padding: 8px 12px;
  border-radius: 999px;
  border: 1px solid rgba(168, 150, 122, 0.22);
  background: var(--linen);
  color: var(--dark-neutral);
  cursor: pointer;
  font-size: 12px;
  letter-spacing: 0.4px;
  transition: all 0.2s ease;
}

.mini-pill:hover {
  background: var(--warm-beige);
}

.mini-pill.active {
  background: var(--soft-brown);
  border-color: var(--soft-brown);
  color: var(--cream);
}

.edit-link {
  background: none;
  border: none;
  color: var(--soft-brown);
  cursor: pointer;
  font-size: 13px;
  text-decoration: underline;
  font-weight: 300;
  opacity: 0.85;
  padding: 0;
}

.edit-link:hover {
  color: var(--dark-neutral);
  opacity: 1;
}


        /* Shopping Cart Sidebar */
        .cart-sidebar {
            position: fixed;
            right: -450px;
            top: 0;
            width: 450px;
            height: 100vh;
            background: var(--linen);
            box-shadow: -8px 0 40px rgba(90, 82, 69, 0.12);
            transition: right 0.5s ease;
            z-index: 2000;
            display: flex;
            flex-direction: column;
        }

        .cart-sidebar.open {
            right: 0;
        }

        .cart-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(90, 82, 69, 0.4);
            display: none;
            z-index: 1999;
            backdrop-filter: blur(4px);
        }

        .cart-overlay.active {
            display: block;
        }

        .cart-header {
            padding: 35px;
            background: var(--warm-beige);
            color: var(--dark-neutral);
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(168, 150, 122, 0.15);
        }

        .cart-header h3 {
            font-size: 24px;
            font-weight: 400;
            letter-spacing: 1px;
            text-transform: lowercase;
        }

        .close-cart {
            background: none;
            border: none;
            color: var(--dark-neutral);
            font-size: 28px;
            cursor: pointer;
            transition: all 0.3s;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            opacity: 0.7;
        }

        .close-cart:hover {
            background: rgba(168, 150, 122, 0.1);
            opacity: 1;
        }

        .cart-items {
            flex: 1;
            overflow-y: auto;
            padding: 25px;
        }

        .cart-item {
            padding: 25px;
            background: var(--cream);
            border-radius: 20px;
            margin-bottom: 18px;
            border: 1px solid rgba(168, 150, 122, 0.1);
        }

        .cart-item h4 {
            color: var(--dark-neutral);
            margin-bottom: 12px;
            font-size: 18px;
            font-weight: 400;
            letter-spacing: 0.5px;
        }

        .cart-item-details {
            font-size: 13px;
            color: var(--soft-brown);
            margin-bottom: 15px;
            line-height: 1.7;
            font-weight: 300;
        }

        .cart-item-price {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 15px;
        }

        .cart-item-price span {
            font-size: 22px;
            font-weight: 300;
            color: var(--dark-neutral);
        }

        .remove-item {
            background: none;
            border: none;
            color: var(--soft-brown);
            cursor: pointer;
            font-size: 13px;
            text-decoration: underline;
            transition: color 0.3s;
            font-weight: 300;
            opacity: 0.8;
        }

        .remove-item:hover {
            color: var(--dark-neutral);
            opacity: 1;
        }

        .cart-footer {
            padding: 35px;
            background: var(--stone);
            border-top: 1px solid rgba(168, 150, 122, 0.15);
        }

        .cart-total {
            display: flex;
            justify-content: space-between;
            font-size: 26px;
            font-weight: 300;
            color: var(--dark-neutral);
            margin-bottom: 25px;
            letter-spacing: 0.5px;
        }

        .checkout-btn {
            width: 100%;
            padding: 18px;
            background: var(--soft-brown);
            color: var(--cream);
            border: none;
            border-radius: 50px;
            font-size: 16px;
            font-weight: 400;
            cursor: pointer;
            transition: all 0.4s ease;
            letter-spacing: 1.5px;
            text-transform: lowercase;
        }

        .checkout-btn:hover {
            background: var(--dark-neutral);
            transform: translateY(-1px);
        }

        .empty-cart {
            text-align: center;
            padding: 80px 30px;
            color: var(--soft-brown);
            font-weight: 300;
        }

        /* Bundle Modal */
        .bundle-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(90, 82, 69, 0.6);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 3000;
            padding: 30px;
            backdrop-filter: blur(6px);
        }

        .bundle-modal.active {
            display: flex;
        }

        .bundle-modal-content {
            background: var(--linen);
            border-radius: 28px;
            padding: 50px;
            max-width: 750px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }

        .bundle-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 35px;
            padding-bottom: 25px;
            border-bottom: 1.5px solid rgba(168, 150, 122, 0.2);
        }

        .bundle-modal-header h3 {
            font-size: 30px;
            color: var(--dark-neutral);
            font-weight: 400;
            letter-spacing: 0.5px;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 32px;
            color: var(--soft-brown);
            cursor: pointer;
            transition: all 0.3s;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            opacity: 0.7;
        }

        .close-modal:hover {
            background: var(--cream);
            opacity: 1;
        }

        .bundle-selection {
            margin-bottom: 35px;
        }

        .bundle-selection h4 {
            font-size: 20px;
            color: var(--dark-neutral);
            margin-bottom: 18px;
            font-weight: 400;
            letter-spacing: 0.5px;
        }

        .milk-selection-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .milk-select-card {
            background: var(--cream);
            border: 1.5px solid transparent;
            border-radius: 18px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .milk-select-card:hover {
            border-color: var(--soft-brown);
            background: var(--warm-beige);
        }

        .milk-select-card.selected {
            border-color: var(--soft-brown);
            background: var(--soft-brown);
        }

        .milk-select-card.selected .milk-select-name {
            color: var(--cream);
        }

        .milk-select-icon {
            font-size: 42px;
            margin-bottom: 10px;
            opacity: 0.9;
        }

        .milk-select-name {
            font-size: 13px;
            color: var(--dark-neutral);
            font-weight: 400;
            letter-spacing: 0.5px;
        }

        .selected-count {
            display: inline-block;
            background: var(--soft-brown);
            color: var(--cream);
            padding: 6px 18px;
            border-radius: 30px;
            font-size: 13px;
            font-weight: 400;
            margin-left: 12px;
            letter-spacing: 0.5px;
        }

        .bundle-customization {
            background: var(--cream);
            padding: 25px;
            border-radius: 18px;
            margin-bottom: 18px;
        }

        .bundle-customization .option-label {
            font-size: 12px;
            min-width: 0;
        }

        .customization-title {
            font-size: 16px;
            color: var(--dark-neutral);
            font-weight: 400;
            margin-bottom: 15px;
            letter-spacing: 0.5px;
        }

        .bundle-temp-selector, .bundle-sweet-selector {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .bundle-modal-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 30px;
            border-top: 1.5px solid rgba(168, 150, 122, 0.2);
        }

        .bundle-total {
            font-size: 36px;
            font-weight: 300;
            color: var(--dark-neutral);
            letter-spacing: -0.5px;
        }

        .add-bundle-btn {
            padding: 18px 45px;
            background: var(--soft-brown);
            color: var(--cream);
            border: none;
            border-radius: 50px;
            font-size: 16px;
            font-weight: 400;
            cursor: pointer;
            transition: all 0.4s ease;
            letter-spacing: 1.5px;
            text-transform: lowercase;
        }

        .add-bundle-btn:hover {
            background: var(--dark-neutral);
            transform: translateY(-1px);
        }

        .add-bundle-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .selection-error {
            color: var(--dark-neutral);
            background: rgba(168, 150, 122, 0.15);
            padding: 15px;
            border-radius: 12px;
            margin-top: 12px;
            font-size: 14px;
            font-weight: 300;
        }

        /* Waitlist Section */
        .waitlist-section {
            background: var(--warm-beige);
        }

        .waitlist-section input {
            background: var(--linen);
            border: 1.5px solid rgba(168, 150, 122, 0.2);
            font-family: 'Optima', 'Segoe UI', sans-serif;
            color: var(--dark-neutral);
            transition: all 0.3s ease;
        }

        .waitlist-section input:focus {
            outline: none;
            border-color: var(--soft-brown);
            background: var(--cream);
        }

        .waitlist-section button:hover {
            background: var(--dark-neutral);
            transform: translateY(-1px);
        }

        /* Footer */
        footer {
            padding: 80px 40px 40px;
            background: var(--linen);
            color: var(--dark-neutral);
            text-align: center;
            border-top: 1px solid rgba(168, 150, 122, 0.15);
        }

        footer a {
            color: var(--soft-brown);
            text-decoration: none;
            transition: all 0.3s;
            font-weight: 300;
        }

        footer a:hover {
            color: var(--dark-neutral);
            opacity: 0.7;
        }

        .footer-links {
            margin: 35px 0;
            display: flex;
            justify-content: center;
            gap: 35px;
            flex-wrap: wrap;
        }

        /* Responsive */
        @media (max-width: 1100px) {
            .milk-grid {
                grid-template-columns: repeat(2, minmax(0, 1fr));
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 0 25px;
            }

            .cart-sidebar {
                width: 100%;
                right: -100%;
            }

            .nav-toggle {
                display: inline-flex;
            }

            .nav-links {
                position: absolute;
                right: 0;
                top: calc(100% + 14px);
                flex-direction: column;
                align-items: flex-start;
                gap: 16px;
                padding: 18px 20px;
                background: var(--linen);
                border-radius: 20px;
                box-shadow: 0 16px 36px rgba(90, 82, 69, 0.12);
                opacity: 0;
                pointer-events: none;
                transform: translateY(-6px);
                transition: all 0.25s ease;
            }

            nav.open .nav-links {
                opacity: 1;
                pointer-events: auto;
                transform: translateY(0);
            }

            .milk-grid {
                grid-template-columns: 1fr;
            }

            .product-image {
                height: 200px;
            }

            .option-row {
                flex-direction: column;
                align-items: flex-start;
            }

            .option-label {
                min-width: 0;
            }

            .cookie-spotlight {
                grid-template-columns: 1fr;
            }

            .cookie-spotlight .cookie-content {
                padding: 22px;
            }

            .bundle-grid {
                grid-template-columns: 1fr;
            }

            .reviews-grid {
                grid-template-columns: 1fr;
            }

            .hero {
                padding: 90px 25px 60px;
                text-align: center;
                height: auto;
            }

            .hero-layout {
                flex-direction: column;
                align-items: center;
            }

            .hero-content {
                max-width: 560px;
            }

            .hero-buttons {
                justify-content: center;
            }

            .hero-image {
                order: 0;
                margin-left: 0;
                width: 100%;
                justify-content: center;
                flex: 0 0 auto;
                height: auto;
                max-width: 100%;
                box-shadow: 0 24px 50px rgba(90, 82, 69, 0.18);
            }

            .hero-image img,
            .hero-image video {
                width: min(520px, 90vw);
                height: auto;
            }


            .featured, .bundles {
                padding: 70px 25px;
            }

            .origin-story {
                padding: 80px 25px;
            }

            .section-divider {
                margin: 0 25px;
            }

            .origin-grid {
                grid-template-columns: 1fr;
                text-align: center;
            }

            .origin-copy {
                margin: 0 auto;
            }

            .origin-copy h2 {
                text-align: center;
            }

            .origin-map {
                padding: 22px;
                margin-left: 0;
            }

            .map-label {
                font-size: 10px;
            }

            .shop-subtitle {
                font-size: 24px;
            }

            .milk-selection-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <!-- Cart Notification -->
    <div class="cart-notification" id="cartNotification">
        âœ“ Added to cart!
    </div>

    <!-- Navigation -->
    <nav>
        <div class="container">
            <a class="logo" href="index.html">AfterHours</a>
            <button class="nav-toggle" type="button" aria-label="Toggle menu" aria-expanded="false" onclick="toggleNav()">
                <span></span>
                <span></span>
                <span></span>
            </button>
            <ul class="nav-links" id="navLinks">
                <li class="nav-dropdown">
                    <a href="#shop" class="nav-link">Shop</a>
                    <div class="dropdown-menu" aria-label="Shop">
                        <a href="#individuals">Milks</a>
                        <a href="#cookie">Signature cookie</a>
                        <a href="#bundles">Comfort bundles</a>
                    </div>
                </li>
                <li><a href="about.html">About</a></li>
                <li><a href="#reviews">Reviews</a></li>
                <li><a href="waitlist.html">Waitlist</a></li>
                <li>
                    <div class="cart-icon" onclick="toggleCart()">
                        ðŸ›’
                        <span class="cart-count" id="cartCount">0</span>
                    </div>
                </li>
            </ul>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero">
        <div class="container hero-layout">
            <div class="hero-content">
                <h1>late nights shouldnâ€™t feel empty</h1>
                <p>when everything is closed and your mind is still on, comfort is hard to find. we bring warm milk and cookies to your door, right when you need them.</p>
                <div class="hero-problem">
                    <span>the problem:</span> midnight cravings, nowhere to go.<br>
                    <span>the fix:</span> soft, warm comfort delivered.
                </div>
                <div class="hero-buttons">
                    <a href="#shop" class="btn-primary">order now</a>
                </div>
            </div>
            <div class="hero-image">
                <video src="assets/videodipping.mp4" autoplay muted loop playsinline></video>
            </div>
        </div>
    </section>

    <!-- Featured Products Section -->
    <section class="featured" id="shop">
        <div class="container">
            <div class="shop-header">
                <h2>shop</h2>
                <p class="section-subtitle">shop the collection: milks, cookies, and comfort bundles</p>
            </div>

            <div class="milk-header" id="individuals">
                <h3 class="shop-subtitle">milks</h3>
                <p class="section-subtitle compact">four signature milks, hot or cold Â· choose sweetness per cup</p>
            </div>
            
            <div class="milk-grid" id="milkGrid">
                <!-- Milks will be dynamically loaded -->
            </div>

            <h3 id="cookie" class="shop-subtitle">signature cookie</h3>
            <p class="section-subtitle compact">baked fresh daily Â· best with a warm pour</p>
            <div class="cookie-spotlight" id="cookieSpotlight"></div>
        </div>
    </section>

    <section class="bundles" id="bundles">
        <div class="container">
          <h2>comfort bundles</h2>
          <p class="section-subtitle">curated sets for every late-night ritual</p>
      
          <div class="bundle-grid">
      
            <div class="bundle-card">
              <span class="bundle-badge">SAVE â‚¹300</span>
              <h3>Moonlight Duo</h3>
              <ul class="bundle-items">
                <li>2 milks of your choice (hot or cold)</li>
                <li>2 signature chocolate chip cookies</li>
              </ul>
              <div class="bundle-price">â‚¹1700 <span>â‚¹2000</span></div>
              <button class="add-to-cart" onclick="openBundleModal('Moonlight Duo', 2, 2, 1700)">Customize Bundle</button>
              <p class="bundle-note">perfect for sharing or savoring slowly</p>
            </div>
      
            <div class="bundle-card">
              <span class="bundle-badge">SAVE â‚¹600</span>
              <h3>Night Owl Trio</h3>
              <ul class="bundle-items">
                <li>3 milks (mix hot & cold)</li>
                <li>4 cookies</li>
              </ul>
              <div class="bundle-price">â‚¹2700 <span>â‚¹3300</span></div>
              <button class="add-to-cart" onclick="openBundleModal('Night Owl Trio', 3, 4, 2700)">Customize Bundle</button>
              <p class="bundle-note">fuel for long nights of focus</p>
            </div>
      
            
      
          </div>
        </div>
      </section>

    <!-- Reviews -->
    <section class="reviews" id="reviews">
        <div class="container">
            <h2>reviews</h2>
            <p class="section-subtitle">notes from friends + family who tried the late-night drop</p>

            <div class="reviews-grid">
                <article class="review-card with-image">
                    <div class="review-image">
                        <img src="assets/review1.JPG" alt="Classic Creamy Milk with cookies on a tray">
                    </div>
                    <div class="review-card-body">
                        <div class="review-header">
                            <div>
                                <div class="review-product">classic creamy milk + cookies</div>
                                <div class="review-meta">friend Â· late-night order</div>
                            </div>
                            <div class="review-stars" aria-label="Rated 5 out of 5">&#9733;&#9733;&#9733;&#9733;&#9733;</div>
                        </div>
                        <p class="review-body">So yummy, just what I craved at night. The milk was still warm when it got here and the cookie was soft in the center.</p>
                        <div class="reviewer">Riya â€” friend</div>
                    </div>
                </article>

                <article class="review-card with-image">
                    <div class="review-image">
                        <img src="assets/review2.JPG" alt="Classic Creamy Milk and cookies close-up">
                    </div>
                    <div class="review-card-body">
                        <div class="review-header">
                            <div>
                                <div class="review-product">classic creamy milk + cookies</div>
                                <div class="review-meta">family Â· weekend treat</div>
                            </div>
                            <div class="review-stars" aria-label="Rated 5 out of 5">&#9733;&#9733;&#9733;&#9733;&#9733;</div>
                        </div>
                        <p class="review-body">Felt like a warm hug after a long day. Not too sweet, and the cookie had that buttery, fresh-baked smell.</p>
                        <div class="reviewer">Auntie Meera â€” family</div>
                    </div>
                </article>
            </div>

            <div class="reviews-grid" style="margin-top: 30px;">
                <article class="review-card">
                    <div class="review-header">
                        <div>
                            <div class="review-product">anijsmelk</div>
                            <div class="review-meta">friend Â· cold</div>
                        </div>
                        <div class="review-stars" aria-label="Rated 4 out of 5">&#9733;&#9733;&#9733;&#9733;&#9734;</div>
                    </div>
                    <p class="review-body">Tastes like a lighter chai without the tea. I kept it cold while studying and it was super calming.</p>
                    <div class="reviewer">Neha â€” friend</div>
                </article>

                <article class="review-card">
                    <div class="review-header">
                        <div>
                            <div class="review-product">cinnamon milk</div>
                            <div class="review-meta">family Â· hot</div>
                        </div>
                        <div class="review-stars" aria-label="Rated 5 out of 5">&#9733;&#9733;&#9733;&#9733;&#9733;</div>
                    </div>
                    <p class="review-body">Not overly sweet, the cinnamon is gentle and cozy. I finished the cup way too fast.</p>
                    <div class="reviewer">Dad â€” family</div>
                </article>

                <article class="review-card">
                    <div class="review-header">
                        <div>
                            <div class="review-product">horchata-style milk</div>
                            <div class="review-meta">friend Â· light sweetness</div>
                        </div>
                        <div class="review-stars" aria-label="Rated 4 out of 5">&#9733;&#9733;&#9733;&#9733;&#9734;</div>
                    </div>
                    <p class="review-body">Creamy and a little nutty. Light sweetness was perfect â€” reminded me of a cafÃ© drink but softer.</p>
                    <div class="reviewer">Aarav â€” friend</div>
                </article>

                <article class="review-card">
                    <div class="review-header">
                        <div>
                            <div class="review-product">signature cookie</div>
                            <div class="review-meta">family Â· late-night snack</div>
                        </div>
                        <div class="review-stars" aria-label="Rated 5 out of 5">&#9733;&#9733;&#9733;&#9733;&#9733;</div>
                    </div>
                    <p class="review-body">Crispy edges, gooey center, still warm even after delivery. I ordered two more.</p>
                    <div class="reviewer">Mom â€” family</div>
                </article>
            </div>
        </div>
    </section>


    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="logo" style="margin-bottom: 25px; font-size: 22px;">afterhours </div>
            <p style="margin-bottom: 20px; font-weight: 300; opacity: 0.8;">late-night milk & cookies delivery at your doorstep</p>
            
            <div class="footer-links">
                <a href="#shop">Shop</a>
                <a href="#bundles">Bundles</a>
                <a href="about.html">About</a>
                <a href="waitlist.html">Waitlist</a>
                <a href="https://www.instagram.com/that.afterhours" target="_blank" rel="noopener noreferrer">Instagram</a>
                <a href="mailto:kalani.varnika@gmail.com">Contact</a>
            </div>
            
            <p style="margin-top: 45px; opacity: 0.5; font-size: 13px; font-weight: 300;">Â© 2026 afterhours Â· for quiet nights</p>
        </div>
    </footer>

    

    <!-- Cart Sidebar -->
    <div class="cart-overlay" id="cartOverlay" onclick="toggleCart()"></div>
    <div class="cart-sidebar" id="cartSidebar">
        <div class="cart-header">
            <h3>Your Cart</h3>
            <button class="close-cart" onclick="toggleCart()">Ã—</button>
        </div>
        <div class="cart-items" id="cartItems">
            <div class="empty-cart">
                <p style="font-size: 48px; margin-bottom: 15px;">ðŸ¥›</p>
                <p>Your cart is empty</p>
                <p style="font-size: 14px; margin-top: 10px;">Add some comfort to your night</p>
            </div>
        </div>
        <div class="cart-footer" id="cartFooter" style="display: none;">
            <div class="cart-total">
                <span>Total:</span>
                <span id="cartTotal">$0</span>
            </div>
            <button class="checkout-btn" onclick="checkout()">Proceed to Checkout</button>
        </div>
    </div>

    <!-- Bundle Customization Modal -->
    <div class="bundle-modal" id="bundleModal">
        <div class="bundle-modal-content">
            <div class="bundle-modal-header">
                <h3 id="bundleModalTitle"></h3>
                <button class="close-modal" onclick="closeBundleModal()">Ã—</button>
            </div>
            
            <div class="bundle-selection">
                <h4>Choose Your Milks <span class="selected-count" id="milkCount">0/0</span></h4>
                <div class="milk-selection-grid" id="milkSelectionGrid"></div>
                <div class="selection-error" id="milkError" style="display: none;"></div>
            </div>

            <div id="customizationOptions"></div>

            <div class="bundle-modal-footer">
                <div class="bundle-total" id="bundleModalPrice"></div>
                <button class="add-bundle-btn" id="addBundleBtn" onclick="addCustomizedBundle()">Add to Cart</button>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>

// ---------- Supabase ----------
const SUPABASE_URL = "https://hkeauskaiaqhrfrzmapz.supabase.co";
const SUPABASE_ANON_KEY = "sb_publishable_WF2-Ksp7qbP7EoKHGAd2Ow_27d4NIdv";
const WAITLIST_TABLE = "waitlist";

const supabaseClient = window.supabase
  ? window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY)
  : null;

function toggleNav(forceOpen) {
  const nav = document.querySelector("nav");
  const btn = document.querySelector(".nav-toggle");
  if (!nav || !btn) return;

  const isOpen = typeof forceOpen === "boolean" ? forceOpen : !nav.classList.contains("open");
  nav.classList.toggle("open", isOpen);
  btn.setAttribute("aria-expanded", String(isOpen));
}

// ---------- Cart helpers ----------
function toggleCart(forceOpen) {
  const sidebar = document.getElementById("cartSidebar");
  const overlay = document.getElementById("cartOverlay");
  if (!sidebar || !overlay) return;

  if (typeof forceOpen === "boolean") {
    sidebar.classList.toggle("open", forceOpen);
    overlay.classList.toggle("active", forceOpen);
    return;
  }

  sidebar.classList.toggle("open");
  overlay.classList.toggle("active");
}

function checkout() {
  if (cart.length === 0) return;

  // close cart
  toggleCart(false);

  const cartSnapshot = getCartSnapshot();
  if (cartSnapshot) {
    try {
      localStorage.setItem("afterhours_cart_snapshot", JSON.stringify(cartSnapshot));
    } catch (err) {
      console.warn("Unable to store cart snapshot.", err);
    }
  }

  setTimeout(() => {
    window.location.href = "waitlist.html";
  }, 200);
}

// optional: close on Escape
document.addEventListener("keydown", (e) => {
  if (e.key === "Escape") {
    toggleCart(false);
    document.getElementById("bundleModal")?.classList.remove("active");
  }
});


        // Product Data (all 200ml)
        const products = [
          {
            id: 1,
            name: "Anijsmelk",
            displayName: "Anijsmelk (Anise Seed Milk)",
            icon: "ðŸŒ¿",
            origin: "Netherlands",
            description: "Warm milk gently infused with aromatic anise seeds.",
            wellness: "Anise is loved for its calming aroma and gentle digestive comfort.",
            price: 700,
            image: "assets/anijsmelk1.png",
            volume: "200ml"
          },
          {
            id: 2,
            name: "Classic Creamy Milk",
            displayName: "Classic Creamy Milk",
            icon: "ðŸ¥›",
            origin: "House Classic",
            description: "Silky, slow-warmed milk with a rich, creamy finish. Simple, nostalgic, perfect with cookies.",
            wellness: "Warm milk is a classic night ritual. Comforting, gentle, and the cleanest pairing for anything sweet.",
            price: 700,
            image: "assets/classic.png",
            volume: "200ml"
          },
          {
            id: 3,
            name: "Cinnamon Milk",
            displayName: "Cinnamon Milk",
            icon: "ðŸŒ™",
            origin: "Global Comfort Tradition",
            description: "Pure milk delicately spiced with Ceylon cinnamon sticks.",
            wellness: "Cinnamonâ€™s warm aroma has been a bedtime companion across cultures for generations.",
            price: 700,
            image: "assets/cinnamon.png",
            volume: "200ml"
          },
          {
            id: 4,
            name: "Horchata-Style",
            displayName: "Horchata-Style Milk",
            icon: "ðŸŒ¾",
            origin: "Mexico",
            description: "Creamy rice-based milk kissed with cinnamon and vanilla bean.",
            wellness: "Light yet indulgent, with a naturally sweet, aromatic finish.",
            price: 700,
            image: "assets/horchata.PNG",
            volume: "200ml"
          },
          {
            id: 5,
            name: "Signature Cookie",
            displayName: "Signature Chocolate Chip Cookie",
            icon: "ðŸª",
            origin: "Baked Fresh Daily",
            description: "Soft, warm chocolate chip cookie with real butter and chocolate chunks.",
            wellness: "Real ingredients, no shortcuts, just comfort in every bite.",
            price: 150,
            image: "assets/cookies.PNG"
          }
        ];

        const defaultMilkOptions = {
          temp: "hot",
          sweetness: "regular",
        };

        function capitalizeWord(value) {
          if (!value) return "";
          return value.charAt(0).toUpperCase() + value.slice(1);
        }

        function formatChoice(temp, sweetness) {
          return `${capitalizeWord(temp)} Â· ${capitalizeWord(sweetness)}`;
        }

        function updateMilkChoice(card) {
          const choice = card?.querySelector(".milk-choice");
          if (!choice) return;
          const temp = card.dataset.temp || defaultMilkOptions.temp;
          const sweetness = card.dataset.sweetness || defaultMilkOptions.sweetness;
          choice.textContent = formatChoice(temp, sweetness);
        }

        function toggleMilkOptions(productId, buttonEl) {
          const card = document.querySelector(`.product-card[data-product-id="${productId}"]`);
          if (!card) return;

          const willOpen = !card.classList.contains("options-open");
          document.querySelectorAll(".product-card.options-open").forEach((openCard) => {
            if (openCard !== card) {
              openCard.classList.remove("options-open");
              const btn = openCard.querySelector(".option-toggle");
              if (btn) {
                btn.textContent = "Choose options";
                btn.setAttribute("aria-expanded", "false");
              }
            }
          });

          card.classList.toggle("options-open", willOpen);
          if (buttonEl) {
            buttonEl.textContent = willOpen ? "Done" : "Choose options";
            buttonEl.setAttribute("aria-expanded", String(willOpen));
          }

          if (willOpen) {
            updateMilkChoice(card);
          }
        }

        // Load Products (THIS was missing)
        function loadProducts() {
          const milkGrid = document.getElementById("milkGrid");
          const cookieSpotlight = document.getElementById("cookieSpotlight");
          if (!milkGrid || !cookieSpotlight) return;

          const milks = products.filter((product) => product.id !== 5);
          const cookie = products.find((product) => product.id === 5);

          milkGrid.innerHTML = milks
            .map((product) => {
              const defaultTemp = defaultMilkOptions.temp;
              const defaultSweetness = defaultMilkOptions.sweetness;

              return `
                <div class="product-card milk-card" data-product-id="${product.id}" data-temp="${defaultTemp}" data-sweetness="${defaultSweetness}">
                  <div class="product-image">
                    ${product.image
                      ? `<img src="${product.image}" alt="${product.displayName}">`
                      : `<span class="product-icon" style="font-size:90px;">${product.icon || "ðŸ¥›"}</span>`
                    }
                  </div>

                  <div class="product-content">
                    <div>
                      <h3>${product.displayName}</h3>
                      <p class="product-origin">${product.origin}${product.volume ? " Â· " + product.volume : ""}</p>
                    </div>

                    <div class="milk-meta">
                      <div class="product-price">â‚¹${product.price}</div>
                      <div class="milk-choice">${formatChoice(defaultTemp, defaultSweetness)}</div>
                    </div>

                    <button class="option-toggle" type="button" aria-expanded="false" onclick="toggleMilkOptions(${product.id}, this)">Choose options</button>

                    <div class="product-options">
                      <div class="option-row">
                        <span class="option-label">temp</span>
                        <div class="temp-selector">
                          <button class="option-btn active" data-value="hot" onclick="selectTemp(${product.id}, 'hot', this)">â˜€ï¸ Hot</button>
                          <button class="option-btn" data-value="cold" onclick="selectTemp(${product.id}, 'cold', this)">â„ï¸ Cold</button>
                        </div>
                      </div>

                      <div class="option-row">
                        <span class="option-label">sweet</span>
                        <div class="sweetness-selector">
                          <button class="option-btn" data-value="light" onclick="selectSweetness(${product.id}, 'light', this)">Light</button>
                          <button class="option-btn active" data-value="regular" onclick="selectSweetness(${product.id}, 'regular', this)">Regular</button>
                        </div>
                      </div>
                    </div>

                    <button class="add-to-cart milk-add" onclick="addToCart(${product.id}, event)">Add to Cart</button>
                  </div>
                </div>
              `;
            })
            .join("");

          if (cookie) {
            cookieSpotlight.innerHTML = `
              <div class="cookie-image">
                ${cookie.image
                  ? `<img src="${cookie.image}" alt="${cookie.displayName}">`
                  : `<span class="product-icon" style="font-size:120px;">${cookie.icon || "ðŸª"}</span>`
                }
              </div>
              <div class="cookie-content">
                <span class="cookie-tag">signature cookie</span>
                <h3>${cookie.displayName}</h3>
                <p class="cookie-desc">${cookie.description}</p>
                <div class="product-price">â‚¹${cookie.price}</div>
                <button class="add-to-cart" onclick="addToCart(${cookie.id}, event)">Add to Cart</button>
              </div>
            `;
          }
        }
      
        // Select Temperature
        function selectTemp(productId, temp, btn) {
          const group = btn.parentElement;
          const card = btn.closest(".product-card");
          group.querySelectorAll(".option-btn").forEach((b) => b.classList.remove("active"));
          btn.classList.add("active");

          if (card) {
            card.dataset.temp = temp;
            updateMilkChoice(card);
          }
        }
      
        // Select Sweetness
        function selectSweetness(productId, level, btn) {
          const group = btn.parentElement;
          const card = btn.closest(".product-card");
          group.querySelectorAll(".option-btn").forEach((b) => b.classList.remove("active"));
          btn.classList.add("active");

          if (card) {
            card.dataset.sweetness = level;
            updateMilkChoice(card);
          }
        }
      
        // Cart notification
        function showCartNotification() {
          const notification = document.getElementById("cartNotification");
          if (!notification) return;
          notification.classList.add("show");
          setTimeout(() => notification.classList.remove("show"), 2000);
        }
      
        // Add to Cart
        function addToCart(productId, event) {
          const button = event?.target;
          const product = products.find((p) => p.id === productId);
          if (!product) return;
      
          let temp = "hot";
          let sweetness = "regular";
          const card = button?.closest(".product-card");
      
          if (productId !== 5 && card) {
            temp = card?.dataset.temp || defaultMilkOptions.temp;
            sweetness = card?.dataset.sweetness || defaultMilkOptions.sweetness;
          } else if (productId === 5) {
            temp = null;
            sweetness = null;
          }
      
          cart.push({
            ...product,
            temp,
            sweetness,
            qty: 1,
            cartId: Date.now()
          });
      
          updateCart();

          if (card?.classList.contains("options-open")) {
            card.classList.remove("options-open");
            const toggle = card.querySelector(".option-toggle");
            if (toggle) {
              toggle.textContent = "Choose options";
              toggle.setAttribute("aria-expanded", "false");
            }
          }

          if (button) {
            button.classList.add("added");
            setTimeout(() => button.classList.remove("added"), 300);
          }
      
          showCartNotification();
        }
      
        // Open Bundle Modal
        function openBundleModal(name, milkCount, cookieCount, price) {
  currentBundle = {
    name,
    milkCount,
    cookieCount,
    price,
    selectedMilks: []
  };

  document.getElementById("bundleModalTitle").textContent = name;
  document.getElementById("bundleModalPrice").textContent = formatINR(price);
  document.getElementById("milkCount").textContent = `0/${milkCount}`;

  const milkProducts = products.filter((p) => p.id !== 5);
  const grid = document.getElementById("milkSelectionGrid");

  grid.innerHTML = milkProducts.map((milk) => `
  <div class="milk-select-card"
       data-milk-id="${milk.id}"
       onclick="toggleMilkSelection(${milk.id}, this)">
    <div class="milk-select-icon">${milk.icon || "ðŸ¥›"}</div>
    <div class="milk-select-name">${milk.name}</div>
  </div>
`).join("");


  document.getElementById("customizationOptions").innerHTML = "";
  document.getElementById("milkError").style.display = "none";
  document.getElementById("bundleModal").classList.add("active");
}

        // Toggle Milk Selection (single correct version)
        function toggleMilkSelection(milkId, cardEl) {
  const index = currentBundle.selectedMilks.findIndex((m) => m.id === milkId);

  if (index > -1) {
    currentBundle.selectedMilks.splice(index, 1);
    cardEl.classList.remove("selected");
  } else {
    if (currentBundle.selectedMilks.length >= currentBundle.milkCount) {
      document.getElementById("milkError").textContent =
        `You can only select ${currentBundle.milkCount} milks for this bundle`;
      document.getElementById("milkError").style.display = "block";
      return;
    }

    const milk = products.find((p) => p.id === milkId);
    currentBundle.selectedMilks.push({
      id: milkId,
      name: milk.name,
      icon: milk.icon || "ðŸ¥›",
      temp: "hot",
      sweetness: "regular",
    });

    cardEl.classList.add("selected");
  }

  document.getElementById("milkCount").textContent =
    `${currentBundle.selectedMilks.length}/${currentBundle.milkCount}`;

  document.getElementById("milkError").style.display = "none";
  updateCustomizationOptions();
}

      
        // Update Customization Options
        function updateCustomizationOptions() {
  const container = document.getElementById("customizationOptions");
  if (!container) return;

  if (currentBundle.selectedMilks.length === 0) {
    container.innerHTML = "";
    return;
  }

  container.innerHTML = currentBundle.selectedMilks
    .map((milk, index) => `
      <div class="bundle-customization">
        <div class="customization-title">${milk.icon || "ðŸ¥›"} ${milk.name}</div>

        <label class="option-label" style="margin-top:10px;display:block;">Temperature:</label>
        <div class="bundle-temp-selector">
          <button class="option-btn ${milk.temp === "hot" ? "active" : ""}"
            onclick="updateBundleMilk(${index}, 'temp', 'hot', this)">â˜€ï¸ Hot</button>
          <button class="option-btn ${milk.temp === "cold" ? "active" : ""}"
            onclick="updateBundleMilk(${index}, 'temp', 'cold', this)">â„ï¸ Cold</button>
        </div>

        <label class="option-label" style="margin-top:10px;display:block;">Sweetness:</label>
        <div class="bundle-sweet-selector">
          <button class="option-btn ${milk.sweetness === "light" ? "active" : ""}"
            onclick="updateBundleMilk(${index}, 'sweetness', 'light', this)">Light</button>
          <button class="option-btn ${milk.sweetness === "regular" ? "active" : ""}"
            onclick="updateBundleMilk(${index}, 'sweetness', 'regular', this)">Regular</button>
        </div>

        <button class="edit-link" style="margin-top:10px;" onclick="removeMilkFromBundle(${index})">
          remove this milk
        </button>
      </div>
    `)
    .join("");
}

// ---------- GLOBALS ----------
let cart = [];
let currentBundle = {
  name: "",
  milkCount: 0,
  cookieCount: 0,
  price: 0,
  selectedMilks: [],
};
window.__editingBundleCartId = null;

const DELIVERY_FEE = 80;
const FREE_DELIVERY_THRESHOLD = 2000;

function formatINR(amount) {
  return `â‚¹${Number(amount).toLocaleString("en-IN")}`;
}

function ensureQty(item) {
  if (!item.qty || item.qty < 1) item.qty = 1;
}

// ---------- CART ----------
function removeFromCart(cartId) {
  cart = cart.filter((item) => item.cartId !== cartId);
  updateCart();
}

function getCartSnapshot() {
  if (!Array.isArray(cart)) return null;
  const items = cart.map((item) => ({
    id: item.id,
    name: item.name || item.displayName || "",
    displayName: item.displayName || item.name || "",
    qty: item.qty || 1,
    price: item.price || 0,
    temp: item.temp || null,
    sweetness: item.sweetness || null,
    isBundle: !!item.isBundle,
    bundleDetails: item.bundleDetails || null,
  }));

  const subtotal = cart.reduce(
    (sum, item) => sum + (item.price || 0) * (item.qty || 1),
    0
  );
  const delivery = subtotal >= FREE_DELIVERY_THRESHOLD
    ? 0
    : subtotal > 0
      ? DELIVERY_FEE
      : 0;
  const total = subtotal + delivery;

  return {
    currency: "INR",
    itemCount: items.reduce((sum, item) => sum + (item.qty || 1), 0),
    subtotal,
    delivery,
    total,
    items,
    capturedAt: new Date().toISOString(),
  };
}

function changeQty(cartId, delta) {
  const item = cart.find((i) => i.cartId === cartId);
  if (!item) return;

  ensureQty(item);
  item.qty += delta;

  if (item.qty <= 0) {
    removeFromCart(cartId);
    return;
  }
  updateCart();
}

function setMilkOption(cartId, key, value) {
  const item = cart.find((i) => i.cartId === cartId);
  if (!item || item.isBundle || item.id === 5) return;

  item[key] = value;
  updateCart();
}

function toggleCartItemEdit(cartId) {
  const item = cart.find((i) => i.cartId === cartId);
  if (!item || item.isBundle || item.id === 5) return;
  item.isEditing = !item.isEditing;
  updateCart();
}

function updateCart() {
  const cartCount = document.getElementById("cartCount");
  const cartItems = document.getElementById("cartItems");
  const cartFooter = document.getElementById("cartFooter");
  if (!cartCount || !cartItems || !cartFooter) return;

  cart.forEach(ensureQty);

  const totalItems = cart.reduce((sum, i) => sum + (i.qty || 1), 0);
  cartCount.textContent = totalItems;

  if (cart.length === 0) {
    cartItems.innerHTML = `
      <div class="empty-cart">
        <p style="font-size:48px;margin-bottom:15px;">ðŸ¥›</p>
        <p>Your cart is empty</p>
        <p style="font-size:14px;margin-top:10px;">Add some comfort to your night</p>
      </div>
    `;
    cartFooter.style.display = "none";
    return;
  }

  cartItems.innerHTML = cart
    .map((item) => {
      const title = `${item.icon || "ðŸ“¦"} ${item.displayName || item.name}`;
      const isCookie = item.id === 5;

      const details = !item.isBundle
        ? isCookie
          ? ``
          : `
        <p class="cart-item-details">
          ${(item.temp || "").charAt(0).toUpperCase() + (item.temp || "").slice(1)}
          ${(item.sweetness
            ? " Â· " + item.sweetness.charAt(0).toUpperCase() + item.sweetness.slice(1)
            : "")}
        </p>

        <button class="edit-link" style="margin-top:8px;" onclick="toggleCartItemEdit(${item.cartId})">
          ${item.isEditing ? "done" : "edit"}
        </button>

        ${item.isEditing ? `
        <div class="mini-edit" style="margin-top:10px;">
          <button class="mini-pill ${item.temp === "hot" ? "active" : ""}" onclick="setMilkOption(${item.cartId}, 'temp', 'hot')">â˜€ï¸ Hot</button>
          <button class="mini-pill ${item.temp === "cold" ? "active" : ""}" onclick="setMilkOption(${item.cartId}, 'temp', 'cold')">â„ï¸ Cold</button>
          <button class="mini-pill ${item.sweetness === "light" ? "active" : ""}" onclick="setMilkOption(${item.cartId}, 'sweetness', 'light')">Light</button>
          <button class="mini-pill ${item.sweetness === "regular" ? "active" : ""}" onclick="setMilkOption(${item.cartId}, 'sweetness', 'regular')">Regular</button>
        </div>
        ` : ``}
      `
        : `
        <div class="cart-item-details">
          ${(item.bundleDetails?.milks || [])
            .map(
              (m) => `<div style="margin:5px 0;font-size:12px;">
              ${m.icon || "ðŸ¥›"} ${m.name} - ${m.temp} Â· ${m.sweetness}
            </div>`
            )
            .join("")}

          <div style="margin-top:8px;font-size:12px;">
            + ${item.bundleDetails?.cookies || 0} cookies ðŸª
          </div>

          <button class="edit-link" style="margin-top:10px;" onclick="editBundleFromCart(${item.cartId})">
            edit
          </button>
        </div>
      `;

      const itemTotal = (item.price || 0) * (item.qty || 1);

      return `
      <div class="cart-item">
        <h4>${title}</h4>
        ${details}

        <div class="cart-controls">
          <div class="qty-control">
            <button class="qty-btn" onclick="changeQty(${item.cartId}, -1)">âˆ’</button>
            <div class="qty-num">${item.qty || 1}</div>
            <button class="qty-btn" onclick="changeQty(${item.cartId}, 1)">+</button>
          </div>

          <div class="cart-item-price" style="margin-top:0; flex:1;">
            <span>${formatINR(itemTotal)}</span>
            <button class="remove-item" onclick="removeFromCart(${item.cartId})">Remove</button>
          </div>
        </div>
      </div>
    `;
    })
    .join("");

  const subtotal = cart.reduce((sum, item) => sum + item.price * (item.qty || 1), 0);
  const delivery = subtotal >= FREE_DELIVERY_THRESHOLD
    ? 0
    : subtotal > 0
      ? DELIVERY_FEE
      : 0;
  const total = subtotal + delivery;

  cartFooter.innerHTML = `
    <div style="display:flex;justify-content:space-between;font-size:14px;margin-bottom:6px;">
      <span>Subtotal</span>
      <span>${formatINR(subtotal)}</span>
    </div>

    <div style="display:flex;justify-content:space-between;font-size:14px;margin-bottom:6px;">
      <span>Delivery</span>
      <span>${delivery === 0 ? "Free" : formatINR(delivery)}</span>
    </div>
    <div style="font-size:11px;letter-spacing:0.5px;opacity:0.7;margin-bottom:12px;">
      Free delivery over â‚¹2,000
    </div>

    <div class="cart-total">
      <span>Total:</span>
      <span>${formatINR(total)}</span>
    </div>

    <button class="checkout-btn" onclick="checkout()">Proceed to Checkout</button>
  `;

  cartFooter.style.display = "block";
}

window.updateCart = updateCart;

// ---------- BUNDLE MODAL HELPERS ----------
function removeMilkFromBundle(index) {
  currentBundle.selectedMilks.splice(index, 1);

  const countEl = document.getElementById("milkCount");
  if (countEl) {
    countEl.textContent = `${currentBundle.selectedMilks.length}/${currentBundle.milkCount}`;
  }

  document.querySelectorAll(".milk-select-card").forEach((card) => {
    const milkId = Number(card.dataset.milkId);
    const selected = currentBundle.selectedMilks.some((m) => m.id === milkId);
    card.classList.toggle("selected", selected);
  });

  const err = document.getElementById("milkError");
  if (err) err.style.display = "none";

  updateCustomizationOptions();
}

function updateBundleMilk(index, property, value, btnEl) {
  const milk = currentBundle.selectedMilks[index];
  if (!milk) return;

  milk[property] = value;

  const group = btnEl?.parentElement;
  if (!group) return;

  group.querySelectorAll(".option-btn").forEach((b) => b.classList.remove("active"));
  btnEl.classList.add("active");
}

function closeBundleModal() {
  document.getElementById("bundleModal")?.classList.remove("active");
  window.__editingBundleCartId = null;

  const btn = document.getElementById("addBundleBtn");
  if (btn) btn.textContent = "Add to Cart";
}
window.closeBundleModal = closeBundleModal;

function addCustomizedBundle() {
  const err = document.getElementById("milkError");

  if (currentBundle.selectedMilks.length !== currentBundle.milkCount) {
    if (err) {
      err.textContent = `Please select exactly ${currentBundle.milkCount} milks`;
      err.style.display = "block";
    }
    return;
  }

  const bundleDetails = {
    milks: currentBundle.selectedMilks.map((m) => ({
      id: m.id,
      name: m.name,
      icon: m.icon || "ðŸ¥›",
      temp: m.temp || "hot",
      sweetness: m.sweetness || "regular",
    })),
    cookies: currentBundle.cookieCount,
  };

  // EDIT EXISTING
  if (window.__editingBundleCartId) {
    const item = cart.find((i) => i.cartId === window.__editingBundleCartId);
    if (item) {
      item.bundleDetails = bundleDetails;
      item.name = currentBundle.name;
      item.price = currentBundle.price;
    }

    updateCart();
    closeBundleModal();
    showCartNotification();
    return;
  }

  // ADD NEW
  cart.push({
    id: "bundle",
    name: currentBundle.name,
    price: currentBundle.price,
    qty: 1,
    cartId: Date.now(),
    isBundle: true,
    bundleDetails,
  });

  updateCart();
  closeBundleModal();
  showCartNotification();
  setTimeout(() => toggleCart(true), 350);
}

// ---------- EDIT BUNDLE FROM CART ----------
function editBundleFromCart(cartId) {
  const item = cart.find((i) => i.cartId === cartId);
  if (!item || !item.isBundle) return;

  currentBundle = {
    name: item.name,
    milkCount: item.bundleDetails?.milks?.length || 0,
    cookieCount: item.bundleDetails?.cookies || 0,
    price: item.price,
    selectedMilks: (item.bundleDetails?.milks || []).map((m) => ({
      id: m.id,
      name: m.name,
      icon: m.icon || "ðŸ¥›",
      temp: m.temp || "hot",
      sweetness: m.sweetness || "regular",
    })),
  };

  window.__editingBundleCartId = cartId;

  document.getElementById("bundleModalTitle").textContent = currentBundle.name;
  document.getElementById("bundleModalPrice").textContent = formatINR(currentBundle.price);
  document.getElementById("milkCount").textContent = `${currentBundle.selectedMilks.length}/${currentBundle.milkCount}`;

  const milkProducts = products.filter((p) => p.id !== 5);
  const grid = document.getElementById("milkSelectionGrid");

  grid.innerHTML = milkProducts
    .map((milk) => {
      const selected = currentBundle.selectedMilks.some((m) => m.id === milk.id);
      return `
      <div class="milk-select-card ${selected ? "selected" : ""}"
           data-milk-id="${milk.id}"
           onclick="toggleMilkSelection(${milk.id}, this)">
        <div class="milk-select-icon">${milk.icon || "ðŸ¥›"}</div>
        <div class="milk-select-name">${milk.name}</div>
      </div>
    `;
    })
    .join("");

  const milkError = document.getElementById("milkError");
  if (milkError) milkError.style.display = "none";

  updateCustomizationOptions();

  const btn = document.getElementById("addBundleBtn");
  if (btn) btn.textContent = "Save Changes";

  document.getElementById("bundleModal").classList.add("active");
}
window.editBundleFromCart = editBundleFromCart;

      
        // Waitlist form
        document.addEventListener("DOMContentLoaded", () => {
          loadProducts();

          const shopDropdown = document.querySelector(".nav-dropdown");
          const shopLink = document.querySelector(".nav-dropdown .nav-link");
          if (shopDropdown && shopLink) {
            shopLink.addEventListener("click", (e) => {
              if (!shopDropdown.classList.contains("open")) {
                e.preventDefault();
                shopDropdown.classList.add("open");
              }
            });

            document.addEventListener("click", (e) => {
              if (!e.target.closest(".nav-dropdown")) {
                shopDropdown.classList.remove("open");
              }
            });
          }

          const navLinks = document.querySelectorAll(".nav-links a");
          navLinks.forEach((link) => {
            link.addEventListener("click", () => {
              if (link.closest(".dropdown-menu")) {
                shopDropdown?.classList.remove("open");
                toggleNav(false);
                return;
              }
              if (link.closest(".nav-dropdown")) return;
              toggleNav(false);
            });
          });

          document.addEventListener("click", (e) => {
            if (!e.target.closest("nav")) {
              toggleNav(false);
            }
          });
      
          const waitlistForm = document.getElementById("waitlistForm");
          waitlistForm?.addEventListener("submit", async (e) => {
            e.preventDefault();

            const successEl = document.getElementById("waitlistSuccess");
            const errorEl = document.getElementById("waitlistError");
            if (successEl) successEl.style.display = "none";
            if (errorEl) errorEl.style.display = "none";

            const name = document.getElementById("waitlistName")?.value?.trim() || "";
            const email = document.getElementById("waitlistEmail")?.value?.trim() || "";
            const phone = document.getElementById("waitlistPhone")?.value?.trim() || "";
            const city = document.getElementById("waitlistCity")?.value?.trim() || "";
            const cartSnapshot = getCartSnapshot();

            if (!supabaseClient) {
              if (errorEl) {
                errorEl.textContent = "Supabase failed to load â€” refresh and try again.";
                errorEl.style.display = "block";
              }
              return;
            }

            const { error } = await supabaseClient.from(WAITLIST_TABLE).insert([
              { name, email, phone, city, cart: cartSnapshot }
            ]);

            if (error) {
              console.error("Supabase insert error:", error);
              if (errorEl) {
                if (error.code === "23505") {
                  errorEl.textContent = "That email is already on the list â€” thank you!";
                } else {
                  errorEl.textContent = error.message || "Couldn't save your info. Please try again.";
                }
                errorEl.style.display = "block";
              }
              return;
            }

            if (successEl) successEl.style.display = "block";
            waitlistForm.reset();
            setTimeout(() => {
              if (successEl) successEl.style.display = "none";
            }, 5000);
          });
      
          // Smooth scroll
          document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
            anchor.addEventListener("click", function (e) {
              e.preventDefault();
              const target = document.querySelector(this.getAttribute("href"));
              target?.scrollIntoView({ behavior: "smooth", block: "start" });
            });
          });
        });

        console.log("JS loaded");

      </script>
      
    
</body>
</html>
